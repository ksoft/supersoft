<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
	<title th:text="#{app.name}">后台登录</title>
	<meta name="renderer" content="webkit">	
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">	
	<meta name="apple-mobile-web-app-capable" content="yes">	
	<meta name="format-detection" content="telephone=no">
    <link th:href="${staticPath}+'/vendor/layui/css/layui.css'" rel="stylesheet"/>
    <link th:href="${staticPath}+'/css/login.css'" rel="stylesheet"/>
    <script type="text/javascript" th:src="${staticPath}+'/vendor/jquery/jquery.js'"></script>
    <script type="text/javascript" th:src="${staticPath}+'/vendor/layui/layui.all.js'"></script>
</head>
<body>
<div class="layui-layout layui-layout-login">
	<h1>
		 <strong th:text="#{app.name}"></strong>
		 <em>Management System</em>
	</h1>
	<div class="layui-user-icon larry-login">
		 <input type="text" name="user_name" placeholder="账号" class="login_txtbx"/>
	</div>
	<div class="layui-pwd-icon larry-login">
		 <input type="password" name="password" placeholder="密码" class="login_txtbx"/>
	</div>
    <div class="layui-val-icon larry-login">
        <div class="layui-code-box">
            <input type="text" id="code" name="code" placeholder="验证码" maxlength="4" class="login_txtbx">
            <img class="verifyImg" th:src="@{/img/code}" src="" alt="验证码" title="点击更换验证码"/>
        </div>
    </div>
    <div class="layui-submit larry-login">
    	<input type="button" value="立即登陆" id="login" class="submit_btn"/>
    </div>
    <div class="layui-login-text">
    	<p>© 2016-2017 SuperSoft 版权所有</p>
        <p>QQ: <a href="http://www.datuzi.vip" title="">1158575655</a></p>
    </div>
</div>
<script type="text/javascript">
$(function(){
    $("body").keydown(function() {
        if (event.keyCode == "13") {//keyCode=13是回车键
            login();
        }
    });

    $('#yzm').focus(function(){
        var text_val=$(this).val();
        if(text_val=='请输入验证码')
        {
            $(this).val('');
        }
    });
    $('#yzm').blur(function(){
        var text_val=$(this).val();
        if(text_val=='')
        {
            $(this).val('请输入验证码');
        }
    });
    $("#login").click(function () {
        login();
    });
    $(".verify-code").click(function(){
        refreshCode();
    });

    function login() {
        var rem = "off";
        if($("b#rem-me").hasClass("next_1")){
            rem = "on";
        }
        if($.trim($("#username").val())==''){
            alert("请输入用户名");
            return;
        }
        if($.trim($("#password").val())==''){
            alert("请输入密码");
            return;
        }
        if($.trim($("input#valid-code").val())==''){
            alert("验证码为空");
            return;
        }
        var data={
            username:$("#username").val(),
            password:$("#password").val(),
            remember:rem,
            code:$("input#valid-code").val()
        };
        $.ajax({
            url:"/auth/login",
            type:'post',
            data:data,
            success:function (result) {
                if(result.success){
                    window.location.href="/index";
                }else {
                    $("div.err-msg").text(result.message);
                    refreshCode();
                }
            }
        })
    }

    function refreshCode() {
        $("img.verify-code").attr("src","/img/code?timestamp="+new Date().getTime());
    }
});
</script>
</body>
</html>